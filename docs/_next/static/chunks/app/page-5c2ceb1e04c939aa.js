(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3983:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>E});var a=t(5155),i=t(5749),l=t(6916),n=t(5462),r=t(9959),c=t(8839),d=t(8297),o=t(5828),m=t(667),x=t(5016),h=t(1847);let u=(0,h.A)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),j=(0,h.A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var v=t(1169);let g=(0,h.A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),p=(0,h.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);function f(e){let{voting:s,status:t,onVote:i,onViewResults:l,onEndVoting:n,canVote:r=!1,hasVoted:h=!1,isCreator:f=!1,isAdmin:N=!1}=e,{t:b}=(0,c.o)(),y="active"===t&&r&&!h,w="ended"===t||h;return(0,a.jsxs)(d.Zp,{className:"voting-card hover:shadow-lg transition-all duration-200",children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(d.ZB,{className:"text-xl mb-2",children:s.title}),(0,a.jsx)(d.BT,{className:"text-sm text-muted-foreground",children:s.description})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(()=>{let e=b("voting.".concat(t)),s="info";switch(t){case"active":s="success";break;case"ended":s="warning";break;case"upcoming":s="info"}return(0,a.jsx)(o.E,{variant:s,children:e})})(),(0,a.jsx)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:s.isPublic?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:b("voting.public")})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:b("voting.private")})]})})]})]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-medium text-sm mb-2",children:[b("form.options"),":"]}),(0,a.jsx)("div",{className:"grid gap-2",children:s.options.map((e,s)=>(0,a.jsxs)("div",{className:"p-2 bg-muted rounded-md text-sm",children:[s+1,". ",e]},s))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("span",{children:[b("voting.total_votes"),": ",s.totalVotes]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g,{className:"w-4 h-4 text-muted-foreground"}),(0,a.jsxs)("span",{children:[b("voting.created_by"),": ",(0,x.LV)(s.creator)]})]})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:["upcoming"===t&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[(0,a.jsx)(p,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[b("voting.starts_at"),": ",(0,x.fU)(s.startTime)]})]}),"active"===t&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,a.jsx)(p,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[b("voting.time_left"),": ",(0,x.$B)(s.endTime)]})]}),"ended"===t&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,a.jsx)(p,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[b("voting.ends_at"),": ",(0,x.fU)(s.endTime)]})]})]}),h&&"active"===t&&(0,a.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md text-sm text-green-800",children:["✅ ",b("msg.already_voted")]}),!r&&"active"===t&&!h&&(0,a.jsxs)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-md text-sm text-yellow-800",children:["⚠️ ",b("msg.not_authorized")]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[y&&(0,a.jsx)(m.$,{onClick:()=>null==i?void 0:i(s.id),className:"flex-1",size:"sm",children:b("voting.vote")}),"active"===t&&!r&&!h&&(0,a.jsx)(m.$,{disabled:!0,variant:"outline",className:"flex-1",size:"sm",children:"Connect Wallet to Vote"}),w&&(0,a.jsx)(m.$,{onClick:()=>null==l?void 0:l(s.id),variant:"outline",className:"flex-1",size:"sm",children:b("voting.results")}),"active"===t&&(f||N)&&(0,a.jsx)(m.$,{onClick:()=>null==n?void 0:n(s.id),variant:"destructive",size:"sm",children:b("common.end")})]})]})})]})}var N=t(2115);let b=(0,N.forwardRef)((e,s)=>{let{className:t,type:i,...l}=e;return(0,a.jsx)("input",{type:i,className:(0,x.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});b.displayName="Input";let y=(0,h.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),w=(0,h.A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),k=(0,h.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);function C(e){let{onSubmit:s,isLoading:t=!1}=e,{t:i}=(0,c.o)(),[l,n]=(0,N.useState)(""),[r,o]=(0,N.useState)(""),[x,h]=(0,N.useState)(["",""]),[v,g]=(0,N.useState)(""),[p,f]=(0,N.useState)(""),[C,T]=(0,N.useState)(!0),[S,M]=(0,N.useState)({}),z=async e=>{if(e.preventDefault(),!(()=>{let e={};if(l.trim()||(e.title="Title is required"),r.trim()||(e.description="Description is required"),x.filter(e=>e.trim()).length<2&&(e.options="At least 2 options are required"),v||(e.startTime="Start time is required"),p||(e.endTime="End time is required"),v&&p){let s=new Date(v).getTime(),t=new Date(p).getTime();s<=Date.now()&&(e.startTime="Start time must be in the future"),t<=s&&(e.endTime="End time must be after start time")}return M(e),0===Object.keys(e).length})())return;let t=x.filter(e=>e.trim()),a=Math.floor(new Date(v).getTime()/1e3),i=Math.floor(new Date(p).getTime()/1e3);try{await s({title:l.trim(),description:r.trim(),options:t,startTime:a,endTime:i,isPublic:C}),n(""),o(""),h(["",""]),g(""),f(""),T(!0),M({})}catch(e){console.error("Failed to create voting:",e)}};return(0,a.jsxs)(d.Zp,{className:"w-full max-w-2xl mx-auto",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(y,{className:"w-5 h-5"}),i("voting.create")]}),(0,a.jsx)(d.BT,{children:"Create a new confidential voting with encrypted votes"})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("form",{onSubmit:z,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[i("form.title")," *"]}),(0,a.jsx)(b,{value:l,onChange:e=>n(e.target.value),placeholder:"Enter voting title",className:S.title?"border-red-500":""}),S.title&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:S.title})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[i("form.description")," *"]}),(0,a.jsx)("textarea",{value:r,onChange:e=>o(e.target.value),placeholder:"Enter voting description",rows:3,className:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(S.description?"border-red-500":"")}),S.description&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:S.description})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[i("form.options")," * (2-4 options)"]}),(0,a.jsxs)("div",{className:"space-y-2",children:[x.map((e,s)=>(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(b,{value:e,onChange:e=>((e,s)=>{let t=[...x];t[e]=s,h(t)})(s,e.target.value),placeholder:"Option ".concat(s+1),className:"flex-1"}),x.length>2&&(0,a.jsx)(m.$,{type:"button",variant:"outline",size:"icon",onClick:()=>{x.length>2&&h(x.filter((e,t)=>t!==s))},children:(0,a.jsx)(w,{className:"w-4 h-4"})})]},s)),x.length<4&&(0,a.jsxs)(m.$,{type:"button",variant:"outline",onClick:()=>{x.length<4&&h([...x,""])},className:"w-full",children:[(0,a.jsx)(y,{className:"w-4 h-4 mr-2"}),i("form.add_option")]})]}),S.options&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:S.options})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[(0,a.jsx)(k,{className:"w-4 h-4 inline mr-1"}),i("form.start_time")," *"]}),(0,a.jsx)(b,{type:"datetime-local",value:v,onChange:e=>g(e.target.value),className:S.startTime?"border-red-500":""}),S.startTime&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:S.startTime})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[(0,a.jsx)(k,{className:"w-4 h-4 inline mr-1"}),i("form.end_time")," *"]}),(0,a.jsx)(b,{type:"datetime-local",value:p,onChange:e=>f(e.target.value),className:S.endTime?"border-red-500":""}),S.endTime&&(0,a.jsx)("p",{className:"text-red-500 text-xs mt-1",children:S.endTime})]})]}),(0,a.jsx)(m.$,{type:"button",variant:"outline",onClick:()=>{let e=new Date,s=new Date(e.getTime()+36e5),t=new Date(e.getTime()+864e5);g(s.toISOString().slice(0,16)),f(t.toISOString().slice(0,16))},className:"w-full",children:"Set Default Times (Start: +1h, End: +1d)"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:i("form.voting_type")}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"votingType",checked:C,onChange:()=>T(!0),className:"w-4 h-4"}),(0,a.jsx)(u,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:i("voting.public")})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"votingType",checked:!C,onChange:()=>T(!1),className:"w-4 h-4"}),(0,a.jsx)(j,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:i("voting.private")})]})]})]}),(0,a.jsx)(m.$,{type:"submit",disabled:t,className:"w-full",size:"lg",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"loading-spinner w-4 h-4 mr-2"}),"Creating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y,{className:"w-4 h-4 mr-2"}),i("voting.create")]})})]})})]})}var T=t(9219),S=t(1437),M=t(6037),z=t(3823);let V=(0,h.A)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);var $=t(534);let A=(0,h.A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),D=(0,h.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function E(){var e,s;let{t,language:x,setLanguage:h}=(0,c.o)(),{storage:u}=(0,l.p)(),{provider:j,chainId:v,accounts:g,isConnected:p,connect:b,disconnect:w,ethersSigner:k,ethersReadonlyProvider:E,sameChain:_,sameSigner:F,initialMockChains:R,status:Z,error:B}=(0,n.h)(),{instance:P,status:W,error:q}=(0,i.w)({provider:j,chainId:v,initialMockChains:R,enabled:p}),I=(0,N.useMemo)(()=>E||new M.FR("https://sepolia.infura.io/v3/".concat("78e2c8be8a32466cae545f06ebc780c1")),[E]),{contractAddress:L,isDeployed:O,canInteract:H,votings:U,votingResults:G,isLoading:K,isCreating:Y,isVoting:J,message:Q,refreshVotings:X,createVoting:ee,castVote:es,endVoting:et,decryptVotingResults:ea,hasVoted:ei,canVote:el,getVotingStatus:en}=(0,r.K)({instance:P,fhevmDecryptionSignatureStorage:u,eip1193Provider:j,chainId:v||31337,ethersSigner:k,ethersReadonlyProvider:I,sameChain:_,sameSigner:F}),[er,ec]=(0,N.useState)("votings"),[ed,eo]=(0,N.useState)(new Map),[em,ex]=(0,N.useState)(!1),[eh,eu]=(0,N.useState)(null),[ej,ev]=(0,N.useState)(!1),[eg,ep]=(0,N.useState)(null);(0,N.useEffect)(()=>{p&&(null==g?void 0:g[0])&&H&&(async()=>{let e=new Map;for(let s of U)try{let[t,a]=await Promise.all([ei(s.id,g[0]),el(s.id,g[0])]);e.set(s.id,{hasVoted:t,canVote:a})}catch(e){console.error("Failed to load state for voting ".concat(s.id,":"),e)}eo(e)})()},[U,g,p,H]);let ef=async e=>{let s=U.find(s=>s.id===e);s&&(eu(s),ex(!0))},eN=async(e,s)=>{try{if(await es(e,s),null==g?void 0:g[0]){let[s,t]=await Promise.all([ei(e,g[0]),el(e,g[0])]);eo(a=>new Map(a.set(e,{hasVoted:s,canVote:t})))}}catch(e){throw console.error("Failed to cast vote:",e),e}},eb=async e=>{let s=U.find(s=>s.id===e);s&&(ep(s),ev(!0))},ey=async e=>{try{await et(e)}catch(e){console.error("Failed to end voting:",e)}},ew=async e=>{await ee(e.title,e.description,e.options,e.startTime,e.endTime,e.isPublic),ec("votings")},ek=(null==g?void 0:g[0])&&L;return p||"create"!==er&&"admin"!==er?!1===O?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)(d.Zp,{className:"w-full max-w-md",children:[(0,a.jsxs)(d.aR,{className:"text-center",children:[(0,a.jsx)(d.ZB,{className:"text-red-600",children:"Contract Not Deployed"}),(0,a.jsxs)(d.BT,{children:["VotingSystem contract not found for chain ID ",v]})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,a.jsx)("p",{children:"Please deploy the contract first:"}),(0,a.jsxs)("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[(0,a.jsxs)("li",{children:["Start Hardhat node: ",(0,a.jsx)("code",{children:"npx hardhat node"})]}),(0,a.jsxs)("li",{children:["Deploy contract: ",(0,a.jsx)("code",{children:"npx hardhat --network localhost deploy --tags VotingSystem"})]}),(0,a.jsx)("li",{children:"Refresh this page"})]})]})})]})}):(0,a.jsxs)("div",{className:"min-h-screen",children:[(0,a.jsx)("header",{className:"border-b bg-card",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(z.A,{className:"w-8 h-8 text-primary"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:t("voting.title")}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:t("voting.subtitle")})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(m.$,{variant:"en"===x?"default":"outline",size:"sm",onClick:()=>h("en"),children:"EN"}),(0,a.jsx)(m.$,{variant:"zh"===x?"default":"outline",size:"sm",onClick:()=>h("zh"),children:"中文"})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.E,{variant:"outline",children:["Chain: ",v]}),(0,a.jsxs)(m.$,{variant:"outline",onClick:w,size:"sm",children:[null==g||null==(e=g[0])?void 0:e.slice(0,6),"...",null==g||null==(s=g[0])?void 0:s.slice(-4)]})]}):(0,a.jsxs)(m.$,{onClick:b,disabled:"connecting"===Z,size:"sm",children:[(0,a.jsx)(V,{className:"w-4 h-4 mr-2"}),t("connecting"===Z?"common.loading":"nav.connect")]})})]})]}),(0,a.jsxs)("div",{className:"flex gap-1 mt-4",children:[(0,a.jsxs)(m.$,{variant:"votings"===er?"default":"ghost",onClick:()=>ec("votings"),size:"sm",children:[(0,a.jsx)($.A,{className:"w-4 h-4 mr-2"}),t("nav.home")]}),(0,a.jsxs)(m.$,{variant:"create"===er?"default":"ghost",onClick:()=>ec("create"),size:"sm",disabled:!p,children:[(0,a.jsx)(y,{className:"w-4 h-4 mr-2"}),t("nav.create")]}),ek&&(0,a.jsxs)(m.$,{variant:"admin"===er?"default":"ghost",onClick:()=>ec("admin"),size:"sm",children:[(0,a.jsx)(A,{className:"w-4 h-4 mr-2"}),t("nav.admin")]})]})]})}),(0,a.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[("ready"!==W||Q)&&(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(d.Zp,{children:(0,a.jsx)(d.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("strong",{children:"FHEVM Status:"})," ",W]}),Q&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:Q})]}),(0,a.jsxs)(m.$,{variant:"outline",size:"sm",onClick:X,disabled:K,children:[(0,a.jsx)(D,{className:"w-4 h-4 mr-2 ".concat(K?"animate-spin":"")}),"Refresh"]})]})})})}),"votings"===er&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Active Votings"}),(0,a.jsxs)(o.E,{variant:"outline",children:[U.length," ",1===U.length?"voting":"votings"]})]}),K?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"loading-spinner w-8 h-8 mx-auto mb-4"}),(0,a.jsx)("p",{children:t("common.loading")})]}):0===U.length?(0,a.jsx)(d.Zp,{children:(0,a.jsxs)(d.Wu,{className:"text-center py-12",children:[(0,a.jsx)(z.A,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No votings yet"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Create the first voting to get started"}),(0,a.jsxs)(m.$,{onClick:()=>ec("create"),children:[(0,a.jsx)(y,{className:"w-4 h-4 mr-2"}),t("voting.create")]})]})}):(0,a.jsx)("div",{className:"voting-grid",children:U.map(e=>{var s;let t=en(e),i=ed.get(e.id),l=(null==g||null==(s=g[0])?void 0:s.toLowerCase())===e.creator.toLowerCase();return(0,a.jsx)(f,{voting:e,status:t,onVote:ef,onViewResults:eb,onEndVoting:ey,canVote:(null==i?void 0:i.canVote)||!1,hasVoted:(null==i?void 0:i.hasVoted)||!1,isCreator:l,isAdmin:ek},e.id)})})]}),"create"===er&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:t("voting.create")}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Create a new confidential voting with encrypted votes"})]}),(0,a.jsx)(C,{onSubmit:ew,isLoading:Y})]}),"admin"===er&&ek&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:t("nav.admin")}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage votings and system settings"})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"System Information"})}),(0,a.jsx)(d.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Contract Address:"}),(0,a.jsx)("p",{className:"font-mono text-xs",children:L})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Chain ID:"}),(0,a.jsx)("p",{children:v})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Total Votings:"}),(0,a.jsx)("p",{children:U.length})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"FHEVM Status:"}),(0,a.jsx)("p",{children:W})]})]})})]})]})]}),eh&&(0,a.jsx)(T.e,{voting:eh,isOpen:em,onClose:()=>ex(!1),onVote:eN,isLoading:J}),eg&&(0,a.jsx)(S.Y,{voting:eg,results:G.get(eg.id),isOpen:ej,onClose:()=>ev(!1),onDecrypt:ea,isDecrypting:K,userAddress:null==g?void 0:g[0]})]}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)(d.Zp,{className:"w-full max-w-md",children:[(0,a.jsxs)(d.aR,{className:"text-center",children:[(0,a.jsxs)(d.ZB,{className:"flex items-center justify-center gap-2 text-2xl",children:[(0,a.jsx)(z.A,{className:"w-8 h-8 text-primary"}),t("voting.title")]}),(0,a.jsx)(d.BT,{children:t("voting.subtitle")})]}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)(m.$,{onClick:b,disabled:"connecting"===Z,className:"w-full",size:"lg",children:[(0,a.jsx)(V,{className:"w-4 h-4 mr-2"}),t("connecting"===Z?"common.loading":"nav.connect")]}),B&&(0,a.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-sm text-red-800",children:B.message}),(0,a.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,a.jsx)(m.$,{variant:"outline",size:"sm",onClick:()=>h("en"),className:"en"===x?"bg-primary text-primary-foreground":"",children:"English"}),(0,a.jsx)(m.$,{variant:"outline",size:"sm",onClick:()=>h("zh"),className:"zh"===x?"bg-primary text-primary-foreground":"",children:"中文"})]})]})]})})}},5242:(e,s,t)=>{Promise.resolve().then(t.bind(t,3983))}},e=>{e.O(0,[349,501,219,874,437,441,255,358],()=>e(e.s=5242)),_N_E=e.O()}]);